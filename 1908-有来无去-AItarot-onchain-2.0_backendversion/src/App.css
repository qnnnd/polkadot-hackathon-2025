/* 页面背景：紫色神秘 + 女巫水印（SVG dataURI） */
.page {
  min-height: 100vh;
  padding: 32px 16px;
  background:
    linear-gradient(rgba(45, 15, 72, 0.6), rgba(45, 15, 72, 0.8)), /* 半透明紫色叠加 */
    url("./assets/background.jpg") center center / cover no-repeat;  /* 万圣节背景图 */
  background-attachment: fixed;
  color: #eee;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
}

/* 玻璃卡片容器 */
.glass{
  max-width:980px; margin:0 auto; padding:28px;
  background: rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.18);
  border-radius:18px; backdrop-filter: blur(8px);
  box-shadow:0 10px 40px rgba(0,0,0,.35);
  position: relative; 
}
.title{ text-align:center; font-size:28px; font-weight:800; letter-spacing:.5px; margin-bottom:18px }

/* 顶部分类选项卡 */
.tabbar{ display:flex; gap:12px; flex-wrap:wrap; margin-bottom:14px }
.tab{
  padding:10px 16px; border-radius:14px;
  background: rgba(255,255,255,.1); color:#e9ddff; font-weight:700;
  transition:.15s; border:1px solid transparent;
}
.tab:hover{ background: rgba(255,255,255,.18) }
.tab.active{
  background:#7c4dff; color:#fff; border-color:#cdbdff; box-shadow:0 6px 18px rgba(124,77,255,.35)
}

/* 表单/按钮微调（选择框 + 输入框都清晰） */
select, input, textarea{
  background: rgba(255,255,255,0.12); color:#fff; border:1px solid rgba(255,255,255,.3);
  border-radius:10px; padding:10px 12px; outline:none; margin:6px 0;
  width:100%;
}
select{ appearance:auto; color-scheme: dark; position:relative; z-index:10 }
select option{ background:#2b1f46; color:#fff }
input::placeholder, textarea::placeholder{ color:#ddd }

/* 抽牌按钮等 */
button{
  cursor:pointer; border:0; border-radius:12px; padding:10px 14px; font-weight:700;
}
button:disabled{ opacity:.6; cursor:wait }
.bg-indigo-500{ background:#6c5ce7; color:#fff }
.bg-green-600{ background:#2ecc71; color:#fff }
.bg-yellow-400{ background:#ffd166; color:#222 }

/* 抽牌区：可视化卡面 + 翻转动画 */
.cards-grid{
  display:grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr));
  gap:16px; margin:18px 0 12px;
}
.slot{ display:flex; flex-direction:column; align-items:center; gap:8px }
.pos-name{ font-size:13px; color:#cfc3ff }
.pos-sub{ font-size:12px; opacity:.8; }

.tarot-card{
  width:140px; height:220px; perspective:1000px; position:relative;
  animation: pop .35s ease;
}
@keyframes pop{ from{ transform:scale(.6); opacity:0 } to{ transform:scale(1); opacity:1 } }

.card-front{
  width:100%; height:100%;
  border-radius:14px; overflow:hidden; position:absolute; top:0; left:0;
  transform-style:preserve-3d; transition: transform .6s ease;
  background: radial-gradient(120px 80px at 30% 20%,rgba(255,255,255,.18),transparent 60%),
              linear-gradient(160deg,#2e1a47,#4b2f78 55%,#8b5cf6);
  border:1px solid rgba(255,255,255,.25);
  box-shadow: 0 6px 28px rgba(0,0,0,.45), inset 0 0 0 1px rgba(0,0,0,.2);
}
.tarot-card.reversed .card-front{ transform: rotate(180deg); }

.card-art{
  height:65%; background:
    radial-gradient(120px 90px at 50% 30%, rgba(255,255,255,.12), transparent 60%),
    repeating-linear-gradient(135deg, rgba(255,255,255,.12) 0 2px, transparent 2px 6px);
  border-bottom:1px dashed rgba(255,255,255,.28);
}
.card-name{
  height:35%; display:flex; align-items:center; justify-content:center;
  font-weight:800; letter-spacing:.8px; text-shadow:0 1px 0 rgba(0,0,0,.6);
}

/* 支付弹窗 */
.modal-mask{
  position:fixed; inset:0; background:rgba(0,0,0,.55);
  display:flex; align-items:center; justify-content:center; z-index:9999;
}
.modal-body{
  width: min(92vw, 520px); background:#1f1433; color:#eee; border-radius:16px;
  border:1px solid rgba(255,255,255,.18); padding:20px 18px; box-shadow:0 12px 36px rgba(0,0,0,.5);
}
.modal-body h3{ margin:2px 0 8px; font-size:20px }
.modal-body .muted{ color:#cdbdff; font-size:13px; margin-bottom:8px }
.addr-row{ display:flex; align-items:center; gap:8px; margin:8px 0 }
.addr{
  display:inline-block; padding:8px 10px; background:rgba(255,255,255,.08); border-radius:10px;
  white-space:nowrap; overflow:auto; max-width: calc(100% - 90px);
}
.qr-wrap{ display:flex; justify-content:center; margin:12px 0 }
.links{ display:flex; gap:8px; justify-content:flex-end }
.btn{ background:#7c4dff; color:#fff }
.btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,.25); color:#fff }
.btn.copy{ background:#4ade80; color:#1a1a1a }
.tiny{ margin-top:10px; font-size:12px; color:#cdbdff }
/* === Tarot 图片展示 === */
.tarot-card {
  width: 110px;      /* 可按需要调整尺寸 */
  height: 180px;
  border-radius: 10px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  object-fit: cover;
  background: #f8f8f8;
}
.tarot-card.reversed {
  transform: rotate(180deg);
}
.tarot-back {
  width: 110px;
  height: 180px;
  border-radius: 10px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  background: url("../src/assets/tarot/back.jpg") center/cover no-repeat;
}
.cards-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}
/* 让上面那排可抽取的牌在抽满后收拢并淡出 */
.pool-row.pack {
  animation: packaway 1.2s ease forwards;  /* 时间可调整 */
}
@keyframes packaway {
  0%   { transform: scale(1); opacity: 1; filter: blur(0px); }
  60%  { transform: scale(0.92); opacity: .6; filter: blur(1px); }
  100% { transform: scale(0.75); opacity: 0; height: 0; margin: 0; padding: 0; }
}

/* 手动模式下，逐条结果的排版，避免文字重叠 */
.result-list { margin-top: 10px; display: grid; grid-template-columns: 1fr; row-gap: 8px; }
.result-line { 
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.16);
  border-radius: 10px;
  padding: 8px 10px;
  line-height: 1.5;
  word-break: break-all;
}

/* —— 抽牌方式切换按钮（无 Tailwind 版本）—— */
.btn-toggle{
  padding: 6px 12px;
  border-radius: 10px;
  border: 1px solid transparent;
  background: #f3f4f6;      /* gray-100 */
  color: #374151;           /* gray-700 */
  font-weight: 700;
  cursor: pointer;
}
.btn-toggle.active{
  background: #fde68a;      /* yellow-200 */
  color: #111827;           /* gray-900 */
  border-color: #fcd34d;    /* yellow-300 */
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
}

/* === Tarot 正/逆位渲染 === */
.tarot-card {
  display: block;
  transform-origin: center;
  transition: transform .25s ease;
}

.tarot-card.reversed {
  transform: rotate(180deg);
}
/* 手动模式：牌背池收起并淡出 */
.pool-row.pack .tarot-card {
  animation: packAway 1.2s ease forwards;
}

@keyframes packAway {
  to {
    transform: translate(-20px, -20px) scale(0.6);
    opacity: 0;
    filter: blur(2px);
  }
}
/* 手动模式：下方逐条结果（自动换行，不重叠） */
.result-list {
  margin-top: 12px;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 8px 16px;
}
@media (max-width: 640px) {
  .result-list { grid-template-columns: 1fr; }
}
.result-line {
  font-size: 14px;
  line-height: 1.55;
  background: rgba(255,255,255,.55);
  border-radius: 10px;
  padding: 8px 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,.06);
}

/* 每张牌+说明的纵向列容器 */
.card-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 120px;           /* 和 .tarot-card 宽度保持一致*/
  margin: 6px 8px;
}

/* 牌下面的说明，自动换行 */
.caption {
  margin-top: 6px;
  font-size: 14px;
  line-height: 1.45;
  max-width: 120px;       /* 跟牌宽一致，防止跑出列外 */
  word-break: break-all;  /* 中文与英文都能在边界换行 */
  text-align: left;       /* 左对齐 */
}

/* 自动模式结果区改为流式网格，整齐排布 */
.mb-4 > .card-col {
  /* 原来外层是 .mb-4 包的结果列表，这里让每个卡片列自然换行 */
  display: inline-flex;
}

/* 空位占位：白色卡槽，带虚线边框 */
.slot-empty{
  width: 120px;             /* 和牌宽一致 */
  height: 180px;            /* 和牌高一致 */
  border-radius: 10px;
  background: #ffffff;      /*“白色”*/
  border: 2px dashed rgba(0,0,0,.18);
  box-shadow: 0 2px 10px rgba(0,0,0,.08) inset;
}

/* —— 翻牌提醒：闪烁吸睛 —— */
.tip-blink{
  display:inline-block;
  padding:6px 10px;
  border-radius:10px;
  background: rgba(255, 214, 102, .18);  
  color:#f59e0b;                         
  font-weight:800;
  border:1px solid rgba(245, 158, 11, .35);
  animation: twinkle 1.1s ease-in-out infinite;
}
@keyframes twinkle{
  0%,100%{ opacity: 1; transform: scale(1); }
  50%    { opacity: .55; transform: scale(0.98); }
}

/* —— 叠放式牌池（可横向滚动、逐张可点）—— */
.deck-wrap{
  position: relative;
  width: 100%;
  padding: 12px 0;
  overflow-x: auto; /* 横向滚动，装得下 78 张 */
}
.deck-stack{
  position: relative;
  /* 高度与 .tarot-card 一致，或者略大一点避免阴影被裁剪 */
  height: 220px; 
  min-width: 280px;
}
.deck-card{
  position: absolute;
  top: 0;
  /* 不写 width/height，让它继承 .tarot-card 的 140x220 */
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,.25);
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease;
  user-select: none;
}
.deck-card:hover{
  transform: translateY(-4px) rotate(-0.3deg);
  box-shadow: 0 10px 24px rgba(0,0,0,.35);
}

/* 抽满后收拢淡出动画 */
.deck-wrap.pack .deck-card{
  opacity: 0;
  transition: opacity .6s ease;
}

/* —— 两行叠放牌池：每行恰好 39 张 —— */
.deck-wrap{
  width: 100%;
  padding: 12px 0 6px;
  display: flex;                 /* 让整体可居中/靠左 */
  justify-content: center;       /* 居中；若想靠左，把这行改成 flex-start */
}

.deck-rows{
  display: flex;
  flex-direction: column;
  gap: 12px;                     /* 两行之间间距 */
}

.deck-row{
  /* 用 CSS 变量精确控制尺寸与叠放步进 */
  --card-w: 140px;               /*  .tarot-card 宽 */
  --card-h: 220px;               /*  .tarot-card 高 */
  --step: 16px;                  /* 叠放步进；16/18都可，想更紧凑就再小一点 */
  --count: 39;                   /* 每行张数 */

  position: relative;
  width: calc(var(--card-w) + (var(--count) - 1) * var(--step));  /* 一行的总宽度 */
  height: var(--card-h);
  overflow: visible;             /* 不裁剪阴影/hover */
  /* 如需靠左：可以把 .deck-wrap 的 justify-content 改 flex-start；这里不用 margin 调整 */
}

.deck-card{
  position: absolute;
  top: 0;
  left: calc(var(--i) * var(--step));  /* 由 JSX 传入 --i = 索引 */
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,.25);
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease;
  user-select: none;
}
.deck-card:hover{
  transform: translateY(-4px) rotate(-0.3deg);
  box-shadow: 0 10px 24px rgba(0,0,0,.35);
}

/* 抽满后可选的淡出动画（沿用 pack 语义） */
.deck-wrap.pack .deck-card{
  opacity: 0;
  transition: opacity .6s ease;
}

@keyframes shufflePulse {
  from {
    box-shadow: 0 0 10px rgba(255,255,255,0.4);
    transform: scale(1);
  }
  to {
    box-shadow: 0 0 24px rgba(255,255,255,0.8);
    transform: scale(1.03);
  }
}

/* === 占卜阶段主容器：洗牌 / 抽牌中 / 结果展示 ===
   这个容器是唯一的“真牌阵”承载点，里面会包含：
   - 洗牌阶段的深蓝色洗牌框（请对着塔罗牌默念你的问题…）
   - 抽牌阶段的候选牌池 + 牌阵
   - 抽牌完成后的最终牌阵
   通过不同状态类（.shuffling / .active / .rise / .hidden）控制它出现位置和可见性
*/

/* 基础形态：默认放在‘开始占卜’按钮正下方这条水平线附近 */
.board-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;

  /* 24px 代表“按钮正下方一行”的视觉位置 */
  margin-top: 24px;
  transform: translateY(0);

  /* 默认不显示，由具体状态类来打开 */
  opacity: 0;

  transition:
    margin-top 1.2s ease,
    transform 1.2s ease,
    opacity 0.6s ease;
}

/* --- 洗牌阶段用：shuffleStage === "shuffling"
   要求：一开始深蓝色洗牌框就出现在高位（别掉到页面中间）
   还要轻微’呼吸‘动画，显得它在“正在洗牌中…” */
.board-wrapper.shuffling {
  /* 还是在按钮下方附近，不要太低 */
  margin-top: 24px;
  transform: translateY(0);
  opacity: 1;

  /* 呼吸动画（下方有 @keyframes shufflePulse） */
  animation: shufflePulse 1s ease-in-out infinite alternate;
}

/* --- 抽牌/翻牌阶段：phase === "in-progress"
   显示候选牌池 + 目前已经抽到/翻开的牌阵
   需求：现在就靠上，不要掉到屏幕中间 */
.board-wrapper.active {
  margin-top: 24px;
  transform: translateY(0);
  opacity: 1;
}

/* --- 抽牌完成：phase === "done" */
.board-wrapper.rise {
  margin-top: 24px;
  transform: translateY(0);
  opacity: 1;
}

/* --- 其他阶段，比如 idle（还没开始占卜）
   把容器隐藏并下沉，这样不会挡住上面的输入区域 */
.board-wrapper.hidden {
  opacity: 0;
  pointer-events: none;

  /* 让它暂时往下缩到视线外 */
  transform: translateY(120px);

  /* 注意：margin-top 保持 24px，不用再额外改值。
     这样 hidden -> active/rise 时不会突然跳个大空洞。 */
}

/* 呼吸动画：给洗牌阶段的深蓝色框一点“活着”的感觉 */
@keyframes shufflePulse {
  0% {
    box-shadow:
      0 0 10px rgba(255,255,255,0.4),
      0 12px 30px rgba(0,0,0,0.6) inset;
    transform: scale(1);
  }
  100% {
    box-shadow:
      0 0 24px rgba(255,255,255,0.8),
      0 12px 30px rgba(0,0,0,0.3) inset;
    transform: scale(1.03);
  }
}

/* 大范围塔罗洗牌动画 */
.shuffle-area {
  position: relative;
  width: min(100%, 720px);

  /* 原来是 260px，这里给它多留一点高度，下面的动画才有地儿摆 */
  height: 320px;

  /* 居中 */
  margin: 0 auto 12px;

  /* 关键：给上面那句文字留空，不要一进来就顶到 0% 的位置 */
  padding-top: 70px;

  /* 让旋转的卡牌不要被裁掉 */
  overflow: visible;
}

.shuffle-card {
  position: absolute;
  width: 110px;
  height: 180px;
  top: 58%;
  left: 50%;
  transform: translate(-50%, -50%);
  border-radius: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,.35);
  animation: shuffleFly 2.6s ease-in-out infinite;
}

.shuffle-card:nth-child(3n) {
  animation-duration: 3s;
}

.shuffle-card:nth-child(4n) {
  animation-duration: 3.4s;
}

/* 0% ～ 70% 乱飞，最后 30% 收回堆成一叠 */
@keyframes shuffleFly {
  0% {
    transform: translate(-50%, -50%) rotate(0deg) scale(0.98);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  30% {
    transform: translate(-140%, -80%) rotate(-14deg) scale(1);
  }
  50% {
    transform: translate(30%, -130%) rotate(10deg) scale(1);
  }
  70% {
    transform: translate(110%, 10%) rotate(-6deg) scale(1);
  }
  90% {
    transform: translate(-50%, -50%) rotate(0deg) scale(1);
  }
  100% {
    transform: translate(-50%, -50%) rotate(0deg) scale(1);
  }
}

/* 手动抽牌阶段的容器：不缩放时的基础样式 */
.manual-choose-wrap {
  transform-origin: top center;
  transition: transform 0.25s ease-out;
}

/* 手动抽牌时（还没抽完）缩小一点点 */
.manual-choose-wrap.scale-down {
  transform: scale(0.75); /* 可以改成 0.75 / 0.8 */
}

/* 当前应抽牌位的红框提示 */
.slot-empty.highlight {
  border: 4px solid #ff4444;         /* 红色高亮边框 */
  box-shadow: 0 0 12px rgba(255,68,68,0.8);
  animation: pulseRed 1s ease-in-out infinite;
}
@keyframes pulseRed {
  0%,100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.8; }
}

/* === LEADERBOARD styles (CTRL+F: LB_CSS) === */
.lb-topbar{
  position:absolute; left:12px; top:10px;
  display:flex; gap:10px; z-index:5;
}
.lb-btn{ background:#7c4dff; color:#fff; padding:8px 12px; border-radius:10px; font-weight:800 }
.lb-btn.ghost{ background:rgba(255,255,255,.12); color:#ddd; border:1px solid rgba(255,255,255,.25) }

.lb-overlay{
  position: fixed; inset: 0; 
  /* 保持本来的背景不变，这里透明覆盖，仅显示一个玻璃卡片 */
  background: transparent; 
  z-index: 9998;
  display:flex; align-items:flex-start; justify-content:center;
  padding: 40px 14px;
}
.lb-card{
  width: min(960px, 96vw);
  background: rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.18);
  border-radius:18px; backdrop-filter: blur(8px);
  box-shadow:0 10px 40px rgba(0,0,0,.35);
  padding: 20px;
  color:#eee;
}
.lb-title{ font-size:22px; font-weight:900; text-align:center; margin:4px 0 14px }
.lb-table{ width:100%; border-collapse:collapse; }
.lb-table thead th{
  text-align:left; font-weight:900; padding:10px 8px; border-bottom:1px solid rgba(255,255,255,.18)
}
.lb-table tbody td{ padding:10px 8px; border-bottom:1px dashed rgba(255,255,255,.12) }
.lb-rank{ width:78px }
.lb-addr{ font-family: ui-monospace, SFMono-Regular, Menlo, monospace }
.lb-score{ width:100px; text-align:right }
